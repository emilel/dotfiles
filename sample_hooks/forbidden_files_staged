#!/usr/bin/zsh

set -euo pipefail

forbidden_files=(
    "pyproject.toml"
)

staged=$(git diff --cached --name-only || true)
matched=()

for f in "${forbidden_files[@]}"; do
    if printf '%s\n' "$staged" | grep -qx "$f"; then
        matched+=("$f")
    fi
done

if [ ${#matched[@]} -gt 0 ]; then
    echo "Double check these staged files:"
    printf '  %s\n' "${matched[@]}"
    exit 1
fi
